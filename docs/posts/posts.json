[
  {
    "path": "posts/2021-11-29-mt-everest/",
    "title": "Mt. Everest",
    "description": "Mountain Everest Deaths and Ascents between 1922-2020. I got two datasets, peak ascents and deaths report for Everest from [The Himalayan Database](https://www.himalayandatabase.com/index.html){target=\"_blank\"} and combined them into one dataset. Most other online database only provide one or two recent year data for free, and I didn't find more avaiable data, so this dataset has limited variables for analysis. Probably could add some weather data like daily wind speed and average temperature as predictors. ðŸ‘‰[National Geographic](https://www.nationalgeographic.org/projects/perpetual-planet/everest/weather-data/){target=\"_blank\"}",
    "author": [],
    "date": "2021-11-29",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nMap\r\nStats\r\nPlots\r\nResult\r\nCode\r\ni. My logistic regression does not work=(\r\nii. knn with SMOTE\r\niii. knn with Up\r\niv. knn with Down\r\n\r\n\r\nNepal is tomorrow~\r\n\r\n\r\n\r\nTime in Nepal\r\n\r\nMap\r\n\r\nStats\r\nsomething is wrong here, NA is more than 215, and the totals are not equal?\r\n\r\n\r\nShow code\r\n\r\nNA_cnt <- table(is.na(total))\r\nNA_pct <- prop.table(NA_cnt)\r\ncbind(NA_cnt, NA_pct)\r\n\r\n\r\n      NA_cnt      NA_pct\r\nFALSE 135076 0.998410833\r\nTRUE     215 0.001589167\r\n\r\nShow code\r\n\r\ntotal <- VIM::kNN(total, \r\n                  variable = c(\"Age\", \"Oxy\"),\r\n                  k = 10)\r\ntotal <- total[, -c(15:16)]\r\ntable(is.na(total))\r\n\r\n\r\n\r\n FALSE \r\n145698 \r\n\r\nShow code\r\n\r\ncounts <- table(total$Dth)\r\nproportions <- prop.table(counts)\r\ncbind(counts, proportions)\r\n\r\n\r\n  counts proportions\r\n0  10101  0.97059671\r\n1    306  0.02940329\r\n\r\nPlots\r\n\r\n\r\nAge Male climbersâ€™ age range are wider than females due to some outliers. We can see the oldest climbers are over 80. 50% of death in females are between age of 30-50 while males are between 30-45. Both gendersâ€™ interquartile ranges are similar among success ascents groups.\r\n\r\n\r\nShow code\r\n\r\nggplot(data = total, \r\n       mapping = aes(x = Sex,\r\n                     y = Age,\r\n                     fill = Dth), na.rm = TRUE) +\r\n  labs(x = \"Sex\",\r\n       y = \"Age\",\r\n       title = \"Age Distribution by Sex and Death\",\r\n       tag = \"Fig. 1\") +\r\n  geom_boxplot(alpha = .3)\r\n\r\n\r\n\r\n\r\n\r\n\r\nCauses More people died the altitude below 7500m because of natural disasters compared to the altitude above 7500m. Death zone1 is defined as altitude that above 8000m, which can cause mountaineers loss physical strength or even vital functions due to low level of concentration of oxygen.I guess I could add some ratio variables for the death rates in different altitude zones? Like death zone and Khumbu Icefall?\r\n =(Had issues with some columns even though I already tried to remove the missing values and it did work when I ran the chunk individually. However, it did not work when I knit the whole post. ðŸ˜©\r\n\r\n\r\nShow code\r\n\r\ntotal %>% \r\n  drop_na(Altitude) %>% \r\n  ggplot(mapping = aes(x = Cause,\r\n                       y = Altitude,\r\n                       fill = Cause)) +\r\n  labs(title = \"Causes of Death by Altitude\",\r\n       tag = \"Fig. 2\") +\r\n  geom_boxplot(alpha = .3) +\r\n  theme(legend.position = \"none\",\r\n        axis.text.x = element_text(angle = 90))\r\n\r\n\r\n\r\n\r\n\r\n\r\nOxy\r\n\r\n\r\nShow code\r\n\r\norder <- c(1, 2, 3, 4) \r\ntotal %>% \r\n  drop_na(Altitude) %>% \r\n  ggplot(mapping = aes(x = factor(Season, level = order),\r\n                       y = Altitude,\r\n                       fill = Oxy)) +\r\n  labs(title = \"Oxygen Consumption by Season\",\r\n       x = \"Season\",\r\n       tag = \"Fig. 3\") +\r\n  geom_boxplot(alpha = .3) +\r\n  scale_x_discrete(labels = c(\"1\" = \"Spring\", \"2\" = \"Summer\", \"3\" = \"Fall\", \"4\" = \"Winter\")) +\r\n  scale_fill_discrete(labels = c(\"Yes\", \"No\", \"NA\"))\r\n\r\n\r\n\r\n\r\n\r\n\r\nOxy by Age Most mountaineers are between 25-45 old\r\n\r\n\r\nShow code\r\n\r\ntotal %>% \r\n  drop_na(Age) %>% \r\n  ggplot(mapping = aes(x = Age,\r\n                     fill = Oxy)) +\r\n  geom_histogram(position = \"stack\",\r\n                 alpha = .6,\r\n                 stat=\"count\") +\r\n  labs(title = \"Histogram: Credit Limit vs Attrition\",\r\n       tag = \"Fig. 4\")\r\n\r\n\r\n\r\n\r\n\r\n\r\nOxy by Altitude Higher consumption of oxygen above 7500m altitude.\r\n\r\n\r\nShow code\r\n\r\ntotal %>% \r\n  drop_na(Altitude) %>% \r\n  ggplot(mapping = aes(x = Altitude,\r\n                       group = Oxy,\r\n                       fill = Oxy)) +\r\n  geom_density(adjust = 1.5, alpha = .4) +\r\n  labs(title = \"Altitude vs Oxygen Consumption\",\r\n       tag = \"Fig. 5\")\r\n\r\n\r\n\r\n\r\n\r\n\r\nSeason Most expeditions happened in spring and some in fall\r\n\r\n\r\nShow code\r\n\r\norder <- c(1, 2, 3, 4)\r\ntotal %>% \r\n  drop_na(Altitude) %>% \r\n  ggplot(mapping = aes(x = Altitude,\r\n                       fill = factor(Season, level = order))) +\r\n  geom_histogram(position = \"stack\",\r\n                 alpha = .5) +\r\n  labs(title = \"Altitude vs Season\",\r\n       tag = \"Fig. 6\") +\r\n  scale_fill_discrete(name = \"Season\", labels = c(\"Spring\", \"Summer\", \"Fall\", \"Winter\"))\r\n\r\n\r\nError: StatBin requires a continuous x variable: the x variable is discrete.Perhaps you want stat=\"count\"?\r\n\r\n\r\n\r\n\r\nResult\r\n\r\n\r\nShow code\r\n\r\ncomparison <- matrix(c(0.9199, 0.2818, 0.6264, 0.9287, \r\n                       0.9327, 0.3152, 0.6044, 0.9426, \r\n                       0.9503, 0.3963, 0.6154, 0.9604),\r\n                     ncol = 4, byrow = TRUE)\r\ncolnames(comparison) <- c(\"Accuracy\", \"Kappa\", \"Recall\", \"Sepecificity\")\r\nrownames(comparison) <- c(\"i.SMOTE\", \"ii.UP\", \"iii.DOWN\")\r\ncomparison <- as.data.frame.matrix(comparison)\r\nkable(comparison) %>% \r\n  row_spec(3, color = \"white\", background = \"#bdaeea\")\r\n\r\n\r\n\r\n\r\n\r\nAccuracy\r\n\r\n\r\nKappa\r\n\r\n\r\nRecall\r\n\r\n\r\nSepecificity\r\n\r\n\r\ni.SMOTE\r\n\r\n\r\n0.9199\r\n\r\n\r\n0.2818\r\n\r\n\r\n0.6264\r\n\r\n\r\n0.9287\r\n\r\n\r\nii.UP\r\n\r\n\r\n0.9327\r\n\r\n\r\n0.3152\r\n\r\n\r\n0.6044\r\n\r\n\r\n0.9426\r\n\r\n\r\niii.DOWN\r\n\r\n\r\n0.9503\r\n\r\n\r\n0.3963\r\n\r\n\r\n0.6154\r\n\r\n\r\n0.9604\r\n\r\n\r\nCode\r\ni. My logistic regression does not work=(\r\n\r\n\r\nShow code\r\n\r\nindex <- createDataPartition(total1$Dth, p = .7, list = FALSE, times = 1)\r\n\r\ntrain <- total1[index,]\r\ntest <- total1[-index,]\r\n\r\nglm <- train(\r\n  form = Dth ~ Age + factor(Oxy),\r\n  data = train,\r\n  trContrl =trainControl(method = \"cv\", number = 10),\r\n  method = \"glm\",\r\n  family = \"binomial\",\r\n  na.action = na.omit\r\n)\r\n\r\n\r\nSomething is wrong; all the Accuracy metric values are missing:\r\n    Accuracy       Kappa    \r\n Min.   : NA   Min.   : NA  \r\n 1st Qu.: NA   1st Qu.: NA  \r\n Median : NA   Median : NA  \r\n Mean   :NaN   Mean   :NaN  \r\n 3rd Qu.: NA   3rd Qu.: NA  \r\n Max.   : NA   Max.   : NA  \r\n NA's   :1     NA's   :1    \r\nError: Stopping\r\n\r\nii. knn with SMOTE\r\n\r\n\r\nShow code\r\n\r\nknn1 <- train( \r\n  Dth ~ factor(Season) + factor(Sex) + Age + factor(Oxy),\r\n  data = train,\r\n  method = \"knn\",\r\n  trControl = trainControl(method = \"cv\", number = 10,\r\n                           sampling = \"smote\"),\r\n  preProcess = c(\"center\", \"scale\"),\r\n  tuneLength = 10,\r\n  na.action = na.omit\r\n)\r\n\r\nplot(knn1)\r\n\r\n\r\n\r\nShow code\r\n\r\nknn1$bestTune\r\n\r\n\r\n    k\r\n10 23\r\n\r\nShow code\r\n\r\npred1 <- predict(knn1, test)\r\nconfusionMatrix(pred1, test$Dth,\r\n                positive = \"1\")\r\n\r\n\r\nConfusion Matrix and Statistics\r\n\r\n          Reference\r\nPrediction    0    1\r\n         0 2814   34\r\n         1  216   57\r\n                                          \r\n               Accuracy : 0.9199          \r\n                 95% CI : (0.9098, 0.9292)\r\n    No Information Rate : 0.9708          \r\n    P-Value [Acc > NIR] : 1               \r\n                                          \r\n                  Kappa : 0.2818          \r\n                                          \r\n Mcnemar's Test P-Value : <2e-16          \r\n                                          \r\n            Sensitivity : 0.62637         \r\n            Specificity : 0.92871         \r\n         Pos Pred Value : 0.20879         \r\n         Neg Pred Value : 0.98806         \r\n             Prevalence : 0.02916         \r\n         Detection Rate : 0.01826         \r\n   Detection Prevalence : 0.08747         \r\n      Balanced Accuracy : 0.77754         \r\n                                          \r\n       'Positive' Class : 1               \r\n                                          \r\n\r\niii. knn with Up\r\n\r\n\r\nShow code\r\n\r\nknn3 <- train( \r\n  Dth ~ factor(Season) + factor(Sex) + Age + factor(Oxy),\r\n  data = train,\r\n  method = \"knn\",\r\n  trControl = trainControl(method = \"cv\", number = 10,\r\n                           sampling = \"up\"),\r\n  preProcess = c(\"center\", \"scale\"),\r\n  tuneLength = 10\r\n)\r\n\r\nplot(knn3)\r\n\r\n\r\n\r\nShow code\r\n\r\nknn3$bestTune\r\n\r\n\r\n  k\r\n1 5\r\n\r\nShow code\r\n\r\npred3 <- predict(knn3, test)\r\nconfusionMatrix(pred3, test$Dth,\r\n                positive = \"1\")\r\n\r\n\r\nConfusion Matrix and Statistics\r\n\r\n          Reference\r\nPrediction    0    1\r\n         0 2856   36\r\n         1  174   55\r\n                                          \r\n               Accuracy : 0.9327          \r\n                 95% CI : (0.9234, 0.9413)\r\n    No Information Rate : 0.9708          \r\n    P-Value [Acc > NIR] : 1               \r\n                                          \r\n                  Kappa : 0.3152          \r\n                                          \r\n Mcnemar's Test P-Value : <2e-16          \r\n                                          \r\n            Sensitivity : 0.60440         \r\n            Specificity : 0.94257         \r\n         Pos Pred Value : 0.24017         \r\n         Neg Pred Value : 0.98755         \r\n             Prevalence : 0.02916         \r\n         Detection Rate : 0.01762         \r\n   Detection Prevalence : 0.07337         \r\n      Balanced Accuracy : 0.77348         \r\n                                          \r\n       'Positive' Class : 1               \r\n                                          \r\n\r\niv. knn with Down\r\n\r\n\r\nShow code\r\n\r\nknn4 <- train( \r\n  Dth ~ factor(Season) + factor(Sex) + Age + factor(Oxy),\r\n  data = train,\r\n  method = \"knn\",\r\n  trControl = trainControl(method = \"cv\", number = 10,\r\n                           sampling = \"down\"),\r\n  preProcess = c(\"center\", \"scale\"),\r\n  tuneLength = 10,\r\n  na.action = na.omit\r\n)\r\n\r\nplot(knn4)\r\n\r\n\r\n\r\nShow code\r\n\r\nknn4$bestTune\r\n\r\n\r\n    k\r\n10 23\r\n\r\nShow code\r\n\r\npred4 <- predict(knn4, test)\r\nconfusionMatrix(pred4, test$Dth,\r\n                positive = \"1\")\r\n\r\n\r\nConfusion Matrix and Statistics\r\n\r\n          Reference\r\nPrediction    0    1\r\n         0 2910   35\r\n         1  120   56\r\n                                          \r\n               Accuracy : 0.9503          \r\n                 95% CI : (0.9421, 0.9577)\r\n    No Information Rate : 0.9708          \r\n    P-Value [Acc > NIR] : 1               \r\n                                          \r\n                  Kappa : 0.3963          \r\n                                          \r\n Mcnemar's Test P-Value : 1.509e-11       \r\n                                          \r\n            Sensitivity : 0.61538         \r\n            Specificity : 0.96040         \r\n         Pos Pred Value : 0.31818         \r\n         Neg Pred Value : 0.98812         \r\n             Prevalence : 0.02916         \r\n         Detection Rate : 0.01794         \r\n   Detection Prevalence : 0.05639         \r\n      Balanced Accuracy : 0.78789         \r\n                                          \r\n       'Positive' Class : 1               \r\n                                          \r\n\r\nR.I.P all the bodies and Hillary Step\r\n\r\nhttps://en.wikipedia.org/wiki/Death_zoneâ†©ï¸Ž\r\n",
    "preview": {},
    "last_modified": "2021-12-06T20:03:01-06:00",
    "input_file": "mt_everest.knit.md"
  }
]
